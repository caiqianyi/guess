<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="renderer" content="webkit|ie-comp|ie-stand">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport"
			content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<link href="/assets/css/bootstrap.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="/css/style.css" />
		<link rel="stylesheet" href="/assets/css/ace.min.css" />
		<link rel="stylesheet" href="/assets/css/font-awesome.min.css" />
		<link rel="stylesheet"
			href="/Widget/zTree/css/zTreeStyle/zTreeStyle.css"
			type="text/css">
			<link href="/Widget/icheck/icheck.css" rel="stylesheet"
				type="text/css" />
			<!--[if IE 7]>
		  <link rel="stylesheet" href="/assets/css/font-awesome-ie7.min.css" />
		<![endif]-->
			<!--[if lte IE 8]>
		  <link rel="stylesheet" href="/assets/css/ace-ie.min.css" />
		<![endif]-->
			<script src="/js/jquery-1.9.1.min.js"></script>
			<script src="/assets/js/bootstrap.min.js"></script>
			<script src="/assets/js/typeahead-bs2.min.js"></script>
			<!-- page specific plugin scripts -->
			<script src="/Widget/datatables/1.10.0/jquery.dataTables.min.js"></script>
			<script src="/assets/js/jquery.dataTables.bootstrap.js"></script>
			<script type="text/javascript" src="/js/H-ui.js"></script>
			<script type="text/javascript" src="/js/H-ui.admin.js"></script>
			<script src="/assets/layer/layer.js" type="text/javascript"></script>
			<script src="/assets/laydate/laydate.js"
				type="text/javascript"></script>
			<script type="text/javascript"
				src="/Widget/zTree/js/jquery.ztree.all-3.5.min.js"></script>
			<script src="/js/lrtk.js" type="text/javascript"></script>
<title>比赛列表</title>
</head>
<body>
	<div class=" page-content clearfix">
		<div id="products_style">
			<div class="search_style">

				<ul class="search_content clearfix">
					<li><label class="l_f">比赛时间</label><input
						class="inline laydate-icon" id="start" style="margin-left: 10px;"></li>
					<li style="width: 90px;"><button type="button"
							class="btn_search">
							<i class="icon-search"></i>查询
						</button></li>
				</ul>
			</div>
			<div class="border clearfix">
		       <span class="l_f">
		        <a href="javascript:void();" title="更新比赛" class="btn btn-warning refresh-match"><i class="icon-refresh"></i>更新比赛</a>
		       </span>
		     </div>
			<!--产品列表展示-->
			<div class="h_products_list clearfix" id="products_list">
				<div id="scrollsidebar" class="left_Treeview">
					<div class="show_btn" id="rightArrow">
						<span></span>
					</div>
				</div>
			</div>
		</div>
		<div class="table_menu_list" id="testIframe">
			<table class="table table-striped table-bordered table-hover"
				id="sample-table">
				<thead>
					<tr>
						<th width="80px">比赛ID</th>
						<th width="100px">联赛</th>
						<th width="100px">主队</th>
						<th width="100px">比分</th>
						<th width="100px">客队</th>
						<th width="80px">让分</th>
						<th width="80px">大小分</th>
						<th width="80px">比赛时间</th>
						<th width="80px">竞猜结束时间</th>
						<th width="80px">比赛状态</th>
						<th width="80px">操作</th>
					</tr>
				</thead>
				<tbody>

				</tbody>
			</table>
		</div>
	</div>
	<!--添加用户图层-->
	<div class="add_menber" id="match_edit_style" style="display:none">
	  
	    <ul class=" page-content">
	     <li><label class="label_name">用&nbsp;&nbsp;户 &nbsp;名：</label><span class="add_name"><input value="" name="用户名" type="text"  class="text_add"/></span><div class="prompt r_f"></div></li>
	     <li><label class="label_name">真实姓名：</label><span class="add_name"><input name="真实姓名" type="text"  class="text_add"/></span><div class="prompt r_f"></div></li>
	     <li><label class="label_name">性&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;别：</label><span class="add_name">
	     <label><input name="form-field-radio" type="radio" checked="checked" class="ace"><span class="lbl">男</span></label>&nbsp;&nbsp;&nbsp;
	     <label><input name="form-field-radio" type="radio" class="ace"><span class="lbl">女</span></label>&nbsp;&nbsp;&nbsp;
	     <label><input name="form-field-radio" type="radio" class="ace"><span class="lbl">保密</span></label>
	     </span>
	     <div class="prompt r_f"></div>
	     </li>
	     <li><label class="label_name">固定电话：</label><span class="add_name"><input name="固定电话" type="text"  class="text_add"/></span><div class="prompt r_f"></div></li>
	     <li><label class="label_name">移动电话：</label><span class="add_name"><input name="移动电话" type="text"  class="text_add"/></span><div class="prompt r_f"></div></li>
	     <li><label class="label_name">电子邮箱：</label><span class="add_name"><input name="电子邮箱" type="text"  class="text_add"/></span><div class="prompt r_f"></div></li>
	     <li class="adderss"><label class="label_name">家庭住址：</label><span class="add_name"><input name="家庭住址" type="text"  class="text_add" style=" width:350px"/></span><div class="prompt r_f"></div></li>
	     <li><label class="label_name">状&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;态：</label><span class="add_name">
	     <label><input name="form-field-radio1" type="radio" checked="checked" class="ace"><span class="lbl">开启</span></label>&nbsp;&nbsp;&nbsp;
	     <label><input name="form-field-radio1"type="radio" class="ace"><span class="lbl">关闭</span></label></span><div class="prompt r_f"></div></li>
	    </ul>
	 </div>
</body>
</html>
<script>
Date.prototype.format = function (fmt) { //author: meizz 
    var o = {
        "M+": this.getMonth() + 1, //月份 
        "d+": this.getDate(), //日 
        "h+": this.getHours(), //小时 
        "m+": this.getMinutes(), //分 
        "s+": this.getSeconds(), //秒 
        "q+": Math.floor((this.getMonth() + 3) / 3), //季度 
        "S": this.getMilliseconds() //毫秒 
    };
    if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
    for (var k in o)
    if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
    return fmt;
}

function match_edit(id){
  layer.open({
	type: 1,
	title: '修改比赛信息',
	maxmin: true, 
	shadeClose:false, //点击遮罩关闭层
     	area : ['800px' , ''],
     	content:$('#match_edit_style'),
	btn:['提交','取消'],
	yes:function(index,layero){	
		var num=0;
		var str="";
  			$(".match_edit input[type$='text']").each(function(n){
       		if($(this).val()==""){
				layer.alert(str+=""+$(this).attr("name")+"不能为空！\r\n",{
              		title: '提示框',				
					icon:0,								
        		}); 
		    	num++;
          		return false;            
       		} 
	 	});
	  	if(num>0){  return false;}	 	
       	else{
			layer.alert('添加成功！',{
            		title: '提示框',				
				icon:1,		
		  	});
		  	layer.close(index);	
	  	}		  		     				
	}
  });
}

var oTable = null;
function query(day){
	if(oTable){
		oTable.fnClearTable();
		oTable.api(0).destroy();
	}
	oTable = $('#sample-table').dataTable({
		ajax: {
	        url: "/jclq/match/day/"+day+".json",
	        dataSrc: 'data'
	    },
		"aaSorting" : [ [  9, "asc" ],[  7, "desc" ]  ],//默认第几个排序
		"bPaginate": false, //翻页功能
		"bLengthChange": false, //改变每页显示数据数量
		"bInfo": false,//页脚信息
		"columns" : [
            { data: 'matchId' },
            { data: 'league' },
            { data: 'hostTeam' },
            { data: 'score' },
            { data: 'gustTeam' },
            { data: 'rf' },
            { data: 'dxf' },
            { data: 'matchTime',fn:function(f){console.info(f)} },
            { data: 'endTime' },
            { data: 'status' },
            { data: 'seq'}
        ],
        "fnCreatedRow": function( nRow, aData, iDataIndex ) {
            // 为a的话字体加粗
            $('td:eq(0)', nRow).html("<a href=\"javascript:layer_show('战绩分析','xi.html?seq="+aData.seq+"&_="+(new Date().getTime())+"',900,810);\">"+aData.matchId+"</a>");
            var so = aData.score.split("-");
            
           	aData.rf = (aData.rf.indexOf("+")>-1||aData.rf.indexOf("-")>-1 ? "": "+")+aData.rf;
           	
            if(aData.status == 2){
            	//console.info(so[0],aData.rf,eval(so[0]+aData.rf));
            	var rfsf = eval(so[0]+aData.rf) > so[1] ? "主胜" :"客胜",
            		dxf = eval(so[0]+"+"+so[1]) > aData.dxf ? "大" : "小";
	            $('td:eq(5)', nRow).html(aData.rf + ' （<font style="color:red">'+rfsf+'</font>）' );
	            $('td:eq(6)', nRow).html(aData.dxf + ' （<font style="color:red">'+dxf+'</font>）' );
        	}
			$('td:eq(7)', nRow).html(new Date(aData.matchTime).format("yyyy-MM-dd hh:mm:ss") );
			$('td:eq(8)', nRow).html(new Date(aData.endTime).format("yyyy-MM-dd hh:mm:ss") );
			$('td:eq(9)', nRow).html(aData.status == 0?"未开始" : aData.status == 1?"进行中":"已结束" );
			var td10 = "<a href=\"javascript:layer_show('欧赔','ou_odds.html?seq="+aData.seq+"&_="+(new Date().getTime())+"','',810);\">欧</a>";
			$('td:eq(10)', nRow).html(td10);
        }
	});
}

$(function($) {
	laydate({
	    elem: '#start',
	    event: 'focus',
	    format: 'YYYYMMDD',
	    istoday: true
	});
	
	var day = new Date().format("yyyyMMdd");
	$('#start').val(day);
	$(".btn_search").click(function(){
		query($("#start").val());
	});
	
	
	$(".refresh-match").click(function(){
		$.ajax({
			url: "/jclq/match/syncData/",
			type: "GET",
			dataType: "json",
			success: function(){
				$(".btn_search").click();
			}
		});
	});
	$(".btn_search").click();
});
//初始化宽度、高度  
$(".widget-box").height($(window).height() - 215);
$(".table_menu_list").width($(window).width() - 260);
$(".table_menu_list").height($(window).height() - 215);
//当文档窗口发生改变时 触发  
$(window).resize(function() {
	$(".widget-box").height($(window).height() - 215);
	$(".table_menu_list").width($(window).width() - 260);
	$(".table_menu_list").height($(window).height() - 215);
})
</script>
